<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tracker-fg</title>
</head>

<style>
body {
  font-family: Arial, Helvetica, sans-serif;
}

.navbar {
  overflow: hidden;
  background-color: #333;
  
}


.navbar a {
  float: left;
  font-size: 16px;
  color: white;
  text-align: center;
  padding: 14px 16px;
  text-decoration: none;
}

.dropdown {
  float: left;
  overflow: hidden;
}

.dropdown .dropbtn {
  font-size: 16px;  
  border: none;
  outline: none;
  color: white;
  padding: 14px 16px;
  background-color: inherit;
  font-family: inherit;
  margin: 0;
}


.navbar a:hover, .dropdown:hover .dropbtn {
  background-color: red;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f9f9f9;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content a {
  float: none;
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.dropdown-content a:hover {
  background-color: lightgreen;
}

.dropdown:hover .dropdown-content {
  display: block;
}

.tabcontent {
  display: none;
}

.flexbox {
          display: flex;
          justify-content: space-evenly;
          text-align: center; 
          flex-wrap: wrap;    
    }

table {
      border: 1px;
      border-style: solid;
      border-color: brown;
      border-collapse: collapse;
      margin-bottom: 20px;
      margin-top: 40px;
      
      
    }
    th, tr, td {
      border: 1px;
      border-style: dashed;
      border-color: brown;
      color: black;
      text-align: center;
      padding: 8px;
    }
   
    .greenSetup {
      width: 250px;
      background-color: rgb(168, 185, 170);
      cursor: pointer;
    }

    .validity {
      background-color: rgb(168, 185, 170);
      cursor: pointer;
      width: 40px;
    } 
    

    .green {
      background-color: rgb(168, 185, 170);
      cursor: pointer;
      width: 180px;
    }

    .inputDate {
      font-size: 0.8rem;
      cursor: pointer;
      
    }

    input {
      cursor: pointer;
      padding: 0;
    }

    .checkbox {
      cursor: pointer;
    }

    #saveButton {
        height: 50px;
        width: 200px;
        background-color: brown;
        font-size: 20px;
        color: aliceblue;
        border-radius: 20px;
        cursor: pointer;
        position: sticky;
        bottom: 100px;
    }

    #headPilot1, #headSubPilot1, #headPilot2, #headSubPilot2 {
      background-color: orange;
    }

</style>

<body>

 

  <body style="background-color:lightgray;">

    <div class="navbar">
      <a class="tablinks" onclick="openTab(event, 'home')">Home</a>
      
      
      <div class="dropdown">
        <button class="dropbtn">Piloten 
        <i class="fa fa-caret-down"></i>
          </button>
            <div class="dropdown-content">
              <a class="tablinks" onclick="openTab(event, 'pilot1')" id="ListNamePilot1"></a>
              <a class="tablinks" onclick="openTab(event, 'pilot2')">Pilot 2</a>
              <a class="tablinks" onclick="openTab(event, 'pilot3')">Pilot 3</a>
              <a class="tablinks" onclick="openTab(event, 'pilot4')">Pilot 4</a>
              <a class="tablinks" onclick="openTab(event, 'pilot5')">Pilot 5</a>
              <a class="tablinks" onclick="openTab(event, 'pilot6')">Pilot 6</a>
              <a class="tablinks" onclick="openTab(event, 'pilot7')">Pilot 7</a>
              <a class="tablinks" onclick="openTab(event, 'pilot8')">Pilot 8</a>
              <a class="tablinks" onclick="openTab(event, 'pilot9')">Pilot 9</a>
              <a class="tablinks" onclick="openTab(event, 'pilot10')">Pilot 10</a>
            </div>
      </div> 

      <a class="tablinks" onclick="openTab(event, 'setup')">Setup</a>
    </div>
    
    <div id="setup" class="tabcontent">
      <h3>Verschiedene Einstellungen</h3>

      <table id="editableTablePilotList">
        <tr>
          <th>No.</th>
          <th>Name</th>
          <th>License No.</th>
        </tr>
        <tr>
          <td>Pilot 1</td>
          <td contenteditable="true" class="greenSetup" id="NamePilot1"></td>
          <td contenteditable="true" class="greenSetup" id="LicenseNoPilot1"></td>
        </tr>
      </table>
    </div>


    <div id="home" class="tabcontent">

      <div class="flexbox">

        <div>
          <table id="editableTablePilot1">
            <tr>
              <th colspan="9" id="headPilot1"></th>
            </tr>
        
            <tr>
              <th>License</th>
              <th>Last Check</th>
              <th>Validity</th>
              <th>Expiry Date</th>
              <th>rem. Days</th>
              <th colspan="3" id="emailSent">Email sent</th>
              <th>New Event</th>
            </tr>
            <tr>
              <td contenteditable="true" class="green" id="LiLane1Pilot1"></td>
              <td><input type="date" class="inputDate" id="lastCheck_Pilot1_2_1"></td>
              <td contenteditable="true" class="validity" id="validityLiLane1Pilot1"></td>
              <td id="newExpiryDateLiLane1Pilot1"></td>
              <td id="remDaysLiLane1Pilot1" class="remDays" ></td>
              <td><input type="checkbox" value="sent" id="emailSent30LiLane1Pilot1">30</td>
              <td><input type="checkbox" value="sent" id="emailSent60LiLane1Pilot1">60</td>
              <td><input type="checkbox" value="sent" id="emailSent90LiLane1Pilot1">90</td>
              <td id="newEventLiLane1Pilot1"><input type="date" class="inputDate"></td>
            </tr>
            <tr>
              <td contenteditable="true" class="green" id="LiLane2Pilot1"></td>
              <td><input type="date" class="inputDate" id="lastCheckLiLane2Pilot1"></td>
              <td contenteditable="true" class="validity" id="validityLiLane2Pilot1"></td>
              <td id="newExpiryDateLiLane2Pilot1"></td>
              <td id="remDaysLiLane2Pilot1"></td>
              <td><input type="checkbox" value="sent" id="emailSent30LiLane2Pilot1">30</td>
              <td><input type="checkbox" value="sent" id="emailSent60LiLane2Pilot1">60</td>
              <td><input type="checkbox" value="sent" id="emailSent90LiLane2Pilot1">90</td>
              <td id="newEventLiLane2Pilot1"><input type="date" class="inputDate"></td>
            </tr>
            <tr>
              <td contenteditable="true" class="green" id="LiLane3Pilot1"></td>
              <td id="lastCheckLiLane3Pilot1"><input type="date" class="inputDate"></td>
              <td contenteditable="true" class="validity" id="validityLiLane3Pilot1"></td>
              <td id="newExpiryDateLiLane3Pilot1"></td>
              <td id="remDaysLiLane3Pilot1"></td>
              <td><input type="checkbox" value="sent" id="emailSent30LiLane3Pilot1">30</td>
              <td><input type="checkbox" value="sent" id="emailSent60LiLane3Pilot1">60</td>
              <td><input type="checkbox" value="sent" id="emailSent90LiLane3Pilot1">90</td>
              <td id="newEventLiLane3Pilot1"><input type="date" class="inputDate"></td>
            </tr>
            <tr>
              <td contenteditable="true" class="green" id="LiLane4Pilot1"></td>
              <td id="lastCheckLiLane4Pilot1"><input type="date" class="inputDate"></td>
              <td contenteditable="true" class="validity" id="validityLiLane4Pilot1"></td>
              <td id="newExpiryDateLiLane4Pilot1"></td>
              <td id="remDaysLiLane4Pilot1"></td>
              <td><input type="checkbox" value="sent" id="emailSent30LiLane4Pilot1">30</td>
              <td><input type="checkbox" value="sent" id="emailSent60LiLane4Pilot1">60</td>
              <td><input type="checkbox" value="sent" id="emailSent90LiLane4Pilot1">90</td>
              <td id="newEventLiLane4Pilot1"><input type="date" class="inputDate"></td>
            </tr>
            <tr>
              <td contenteditable="true" class="green" id="LiLane5Pilot1"></td>
              <td id="lastCheckLiLane5Pilot1"><input type="date" class="inputDate"></td>
              <td contenteditable="true" class="validity" id="validityLiLane5Pilot1"></td>
              <td id="newExpiryDateLiLane5Pilot1"></td>
              <td id="remDaysLiLane5Pilot1"></td>
              <td><input type="checkbox" value="sent" id="emailSent30LiLane5Pilot1">30</td>
              <td><input type="checkbox" value="sent" id="emailSent60LiLane5Pilot1">60</td>
              <td><input type="checkbox" value="sent" id="emailSent90LiLane5Pilot1">90</td>
              <td id="newEventLiLane5Pilot1"><input type="date" class="inputDate"></td>
            </tr>
            <tr>
              <td contenteditable="true" class="green" id="LiLane6Pilot1"></td>
              <td id="lastCheckLiLane6Pilot1"><input type="date" class="inputDate"></td>
              <td contenteditable="true" class="validity" id="validityLiLane6Pilot1"></td>
              <td id="newExpiryDateLiLane6Pilot1"></td>
              <td id="remDaysLiLane6Pilot1"></td>
              <td><input type="checkbox" value="sent" id="emailSent30LiLane6Pilot1">30</td>
              <td><input type="checkbox" value="sent" id="emailSent60LiLane6Pilot1">60</td>
              <td><input type="checkbox" value="sent" id="emailSent90LiLane6Pilot1">90</td>
              <td id="newEventLiLane6Pilot1"><input type="date" class="inputDate"></td>
            </tr>
            <tr>
              <td contenteditable="true" class="green" id="LiLane7Pilot1"></td>
              <td id="lastCheckLiLane7Pilot1"><input type="date" class="inputDate"></td>
              <td contenteditable="true" class="validity" id="validityLiLane7Pilot1"></td>
              <td id="newExpiryDateLiLane7Pilot1"></td>
              <td id="remDaysLiLane7Pilot1"></td>
              <td><input type="checkbox" value="sent" id="emailSent30LiLane7Pilot1">30</td>
              <td><input type="checkbox" value="sent" id="emailSent60LiLane7Pilot1">60</td>
              <td><input type="checkbox" value="sent" id="emailSent90LiLane7Pilot1">90</td>
              <td id="newEventLiLane7Pilot1"><input type="date" class="inputDate"></td>
            </tr>
            <tr>
              <td contenteditable="true" class="green" id="LiLane8Pilot1"></td>
              <td id="lastCheckLiLane8Pilot1"><input type="date" class="inputDate"></td>
              <td contenteditable="true" class="validity" id="validityLiLane8Pilot1"></td>
              <td id="newExpiryDateLiLane8Pilot1"></td>
              <td id="remDaysLiLane8Pilot1"></td>
              <td><input type="checkbox" value="sent" id="emailSent30LiLane8Pilot1">30</td>
              <td><input type="checkbox" value="sent" id="emailSent60LiLane8Pilot1">60</td>
              <td><input type="checkbox" value="sent" id="emailSent90LiLane8Pilot1">90</td>
              <td id="newEventLiLane8Pilot1"><input type="date" class="inputDate"></td>
            </tr>
            <tr>
              <td contenteditable="true" class="green" id="LiLane9Pilot1"></td>
              <td id="lastCheckLiLane9Pilot1"><input type="date" class="inputDate"></td>
              <td contenteditable="true" class="validity" id="validityLiLane9Pilot1"></td>
              <td id="newExpiryDateLiLane9Pilot1"></td>
              <td id="remDaysLiLane9Pilot1"></td>
              <td><input type="checkbox" value="sent" id="emailSent30LiLane9Pilot1">30</td>
              <td><input type="checkbox" value="sent" id="emailSent60LiLane9Pilot1">60</td>
              <td><input type="checkbox" value="sent" id="emailSent90LiLane9Pilot1">90</td>
              <td id="newEventLiLane9Pilot1"><input type="date" class="inputDate"></td>
            </tr>
            <tr>
              <td contenteditable="true" class="green" id="LiLane10Pilot1"></td>
              <td id="lastCheckLiLane10Pilot1"><input type="date" class="inputDate"></td>
              <td contenteditable="true" class="validity" id="validityLiLane10Pilot1"></td>
              <td id="newExpiryDateLiLane10Pilot1"></td>
              <td id="remDaysLiLane10Pilot1"></td>
              <td><input type="checkbox" value="sent" id="emailSent30LiLane10Pilot1">30</td>
              <td><input type="checkbox" value="sent" id="emailSent60LiLane10Pilot1">60</td>
              <td><input type="checkbox" value="sent" id="emailSent90LiLane10Pilot1">90</td>
              <td id="newEventLiLane10Pilot1"><input type="date" class="inputDate"></td>
            </tr>
            <tr>
              <td contenteditable="true" class="green" id="LiLane11Pilot1"></td>
              <td id="lastCheckLiLane11Pilot1"><input type="date" class="inputDate"></td>
              <td contenteditable="true" class="validity" id="validityLiLane11Pilot1"></td>
              <td id="newExpiryDateLiLane11Pilot1"></td>
              <td id="remDaysLiLane11Pilot1"></td>
              <td><input type="checkbox" value="sent" id="emailSent30LiLane11Pilot1">30</td>
              <td><input type="checkbox" value="sent" id="emailSent60LiLane11Pilot1">60</td>
              <td><input type="checkbox" value="sent" id="emailSent90LiLane11Pilot1">90</td>
              <td id="newEventLiLane11Pilot1"><input type="date" class="inputDate"></td>
            </tr>
            <tr>
              <td contenteditable="true" class="green" id="LiLane12Pilot1"></td>
              <td id="lastCheckLiLane12Pilot1"><input type="date" class="inputDate"></td>
              <td contenteditable="true" class="validity" id="validityLiLane12Pilot1"></td>
              <td id="newExpiryDateLiLane12Pilot1"></td>
              <td id="remDaysLiLane12Pilot1"></td>
              <td><input type="checkbox" value="sent" id="emailSent30LiLane12Pilot1">30</td>
              <td><input type="checkbox" value="sent" id="emailSent60LiLane12Pilot1">60</td>
              <td><input type="checkbox" value="sent" id="emailSent90LiLane12Pilot1">90</td>
              <td id="newEventLiLane12Pilot1"><input type="date" class="inputDate"></td>
            </tr>
            <tr>
              <td contenteditable="true" class="green" id="LiLane13Pilot1"></td>
              <td id="lastCheckLiLane13Pilot1"><input type="date" class="inputDate"></td>
              <td contenteditable="true" class="validity" id="validityLiLane13Pilot1"></td>
              <td id="newExpiryDateLiLane13Pilot1"></td>
              <td id="remDaysLiLane13Pilot1"></td>
              <td><input type="checkbox" value="sent" id="emailSent30LiLane13Pilot1">30</td>
              <td><input type="checkbox" value="sent" id="emailSent60LiLane13Pilot1">60</td>
              <td><input type="checkbox" value="sent" id="emailSent90LiLane13Pilot1">90</td>
              <td id="newEventLiLane13Pilot1"><input type="date" class="inputDate"></td>
            </tr>
            <tr>
              <td contenteditable="true" class="green" id="LiLane14Pilot1"></td>
              <td id="lastCheckLiLane14Pilot1"><input type="date" class="inputDate"></td>
              <td contenteditable="true" class="validity" id="validityLiLane14Pilot1"></td>
              <td id="newExpiryDateLiLane14Pilot1"></td>
              <td id="remDaysLiLane14Pilot1"></td>
              <td><input type="checkbox" value="sent" id="emailSent30LiLane14Pilot1">30</td>
              <td><input type="checkbox" value="sent" id="emailSent60LiLane14Pilot1">60</td>
              <td><input type="checkbox" value="sent" id="emailSent90LiLane14Pilot1">90</td>
              <td id="newEventLiLane14Pilot1"><input type="date" class="inputDate"></td>
            </tr>
            <tr>
              <td contenteditable="true" class="green" id="LiLane15Pilot1"></td>
              <td id="lastCheckLiLane15Pilot1"><input type="date" class="inputDate"></td>
              <td contenteditable="true" class="validity" id="validityLiLane15Pilot1"></td>
              <td id="newExpiryDateLiLane15Pilot1"></td>
              <td id="remDaysLiLane15Pilot1"></td>
              <td><input type="checkbox" value="sent" id="emailSent30LiLane15Pilot1">30</td>
              <td><input type="checkbox" value="sent" id="emailSent60LiLane15Pilot1">60</td>
              <td><input type="checkbox" value="sent" id="emailSent90LiLane15Pilot1">90</td>
              <td id="newEventLiLane15Pilot1"><input type="date" class="inputDate"></td>
            </tr>

          </table>
        </div>

      </div>  


<!-- BITTE √ºberpr√ºfen - es funktioniert nur der Return button zum speichern !!!!!!!-->
      
     

    </div>



<div id="pilot1" class="tabcontent">
      <h4 id="PageNamePilot1"></h4>
      <p>Daten von einmaligen Ereignissen des Piloten</p>
   

  <div class="flexbox">
    <div>
      <table id="editableTableSubPilot1">
        <tr>
          <th colspan="3" id="headSubPilot1"></th>
        </tr>
        
        <tr>
          <th>Subject</th>
          <th>Initial Date</th>
          <th>Approved</th>
        </tr>
        <tr>
          <td contenteditable="true" class="green"></td>
          <td id="initialDateLane1Pilot1"><input type="date" class="inputDate"></td>
          <td><input type="checkbox" value="approved" id="approvedLane1Pilot1"></td>
        </tr>
        <tr>
          <td contenteditable="true" class="green"></td>
          <td id="initialDateLane2Pilot1"><input type="date" class="inputDate"></td>
          <td ><input type="checkbox" value="approved" id="approvedLane2Pilot1"></td>
        </tr>
        <tr>
          <td contenteditable="true" class="green"></td>
          <td id="initialDateLane3Pilot1"><input type="date" class="inputDate"></td>
          <td ><input type="checkbox" value="approved" id="approvedLane3Pilot1"></td>
        </tr>
        <tr>
          <td contenteditable="true" class="green"></td>
          <td id="initialDateLane4Pilot1"><input type="date" class="inputDate"></td>
          <td ><input type="checkbox" value="approved" id="approvedLane4Pilot1"></td>
        </tr>
        <tr>
          <td contenteditable="true" class="green"></td>
          <td id="initialDateLane5Pilot1"><input type="date" class="inputDate"></td>
          <td ><input type="checkbox" value="approved" id="approvedLane5Pilot1"></td>
        </tr>
        <tr>
          <td contenteditable="true" class="green"></td>
          <td id="initialDateLane6Pilot1"><input type="date" class="inputDate"></td>
          <td ><input type="checkbox" value="approved" id="approvedLane6Pilot1"></td>
        </tr>
        <tr>
          <td contenteditable="true" class="green"></td>
          <td id="initialDateLane7Pilot1"><input type="date" class="inputDate"></td>
          <td ><input type="checkbox" value="approved" id="approvedLane7Pilot1"></td>
        </tr>
        <tr>
          <td contenteditable="true" class="green"></td>
          <td id="initialDateLane8Pilot1"><input type="date" class="inputDate"></td>
          <td ><input type="checkbox" value="approved" id="approvedLane8Pilot1"></td>
        </tr>
        <tr>
          <td contenteditable="true" class="green"></td>
          <td id="initialDateLane9Pilot1"><input type="date" class="inputDate"></td>
          <td ><input type="checkbox" value="approved" id="approvedLane9Pilot1"></td>
        </tr>
        <tr>
          <td contenteditable="true" class="green"></td>
          <td id="initialDateLane10Pilot1"><input type="date" class="inputDate"></td>
          <td ><input type="checkbox" value="approved" id="approvedLane10Pilot1"></td>
        </tr>
      </table>
    </div>
  </div>
</div>    



<!-- ID Pilot 2 -->    

   

    </div>

<!--      <button id="saveButton">Update/Save values</button> -->

    </div>

    <div id="pilot3" class="tabcontent">
      <p> hier die tabelle von Pilot 3</p>
    </div>

    <div id="pilot4" class="tabcontent">
      <p> hier die tabelle von Pilot 4</p>
    </div>



    <button id="saveButton" onclick="saveTableData('Pilot1'), saveTableData('PilotList'), saveTableData('SubPilot1')">Update/Save values</button>

    <!--
    <button id="loadButton" onclick="loadTableData('Pilot1'), loadTableData('PilotList'), loadTableData('SubPilot1')">Load values/tables</button>
    -->
   

<script>

   
 // wenn Enter gedr√ºckt wird - wird der saveButton geklickt/ausgef√ºhrt
    addEventListener("keypress", function(event) {
        if (event.key === "Enter") {
        document.getElementById("saveButton").click();
        }
    });   


    document.querySelectorAll(".tablinks").forEach(tab => {
      tab.addEventListener("click", function () {
      sessionStorage.setItem("activeTab", this.getAttribute("onclick").match(/'([^']+)'/)[1]);
      });
    });

    // Beim reload auf die vorherige/aktuelle Seite
    window.addEventListener("load", function () {
      const savedTab = sessionStorage.getItem("activeTab");
      if (savedTab) {
      openTab({ currentTarget: document.querySelector(`[onclick*="${savedTab}"]`) }, savedTab);
      } else {
      openTab({ currentTarget: document.querySelector(`[onclick*="home"]`) }, "home");
      }
    });



  function openTab(evt, tabName) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i=0; i<tabcontent.length; i++) {
      tabcontent[i].style.display = "none";
    }

    tablinks = document.getElementsByClassName("tablinks");
    for (i=0; i<tablinks.length; i++) {
      tablinks[i].className = tablinks[i].className.replace("active", "");
    }

    document.getElementById(tabName).style.display = "block";
    evt.currentTarget.className += "active";
  }

 



// Funktion zum Laden der Tabelle von Server
async function loadTableData(tableName) {
    return fetch(`http://217.154.84.3/loadTable?tableName=${tableName}&nocache=${new Date().getTime()}`)
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP-Fehler! Status: ${response.status}`);
            }
            return response.json();
        })
        .then(storedData => {
            console.log("‚úÖ Daten f√ºr", tableName, "geladen:", storedData);

            const table = document.getElementById("editableTable" + tableName);
            if (storedData && storedData.length > 0) {
                for (let i = 1; i < table.rows.length; i++) {
                    const row = table.rows[i];
                    if (storedData[i - 1]) {
                        for (let j = 0; j < row.cells.length; j++) {
                            const cell = row.cells[j];

                            const inputCheckbox = cell.querySelector("input[type='checkbox']");
                            if (inputCheckbox) {
                                inputCheckbox.checked = storedData[i - 1][j] === "sent";
                            } else if (storedData[i - 1][j].match(/^\d{4}-\d{2}-\d{2}$/) || cell.querySelector("input[type='date']")) { 
                                cell.innerHTML = "";
                                const inputDate = document.createElement("input");
                                inputDate.type = "date";
                                inputDate.id = `lastCheck_${tableName}_${i}_${j}`;
                                inputDate.value = storedData[i - 1][j];
                                cell.appendChild(inputDate);
                            } else {
                                cell.innerText = storedData[i - 1][j];
                            }
                        }
                    }
                }
            }
        })
        .catch(error => console.error("‚ùå Fehler beim Laden der Daten:", error));
}


// Buttons zum Speichern der Daten (aufrufbar f√ºr jede Tabelle)
document.getElementById("saveButton").onclick = function() {
    saveTableData("Pilot1").then(() => loadTableData("Pilot1").then(() => starteBerechnung()));
    saveTableData("SubPilot1").then(() => loadTableData("SubPilot1").then(() => starteBerechnung()));
    saveTableData("PilotList").then(() => loadTableData("PilotList").then(() => starteBerechnung()));
};

  


  // SERVER STORAGE - Funktion zum Speichern der Tabellen auf dem Server
// Funktion zum Speichern der Tabelle auf dem Server
function saveTableData(tableName) {
    return new Promise((resolve, reject) => {  // Hier ein Promise erstellen
        const table = document.getElementById("editableTable" + tableName);
        const rows = table.rows;
        const tableData = [];

        for (let i = 1; i < rows.length; i++) {
            const rowData = [];
            for (let j = 0; j < rows[i].cells.length; j++) {
                const cell = rows[i].cells[j];

                const inputCheckbox = cell.querySelector("input[type='checkbox']");
                const inputDate = cell.querySelector("input[type='date']");
                if (inputCheckbox) {
                    rowData.push(inputCheckbox.checked ? "sent" : "not sent");
                } else if (inputDate) {
                    rowData.push(inputDate.value);
                } else {
                    rowData.push(cell.innerText);
                }
            }
            tableData.push(rowData);
        }

        fetch("http://217.154.84.3/saveTable", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ tableName, tableData })
        })
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP-Fehler! Status: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            console.log("‚úÖ Server-Best√§tigung:", data);
            resolve(data); // Promise erfolgreich abschlie√üen
        })
        .catch(error => {
            console.error("‚ùå Fehler beim Speichern:", error);
            reject(error); // Fehler an das Promise weitergeben
        });
    });
    
}
window.onload = function() {
    loadAllTables(); // Startet das Laden aller Tabellen + Berechnung
};

async function loadAllTables() {
    console.log("üöÄ Lade alle Tabellen...");
    await loadTableData("Pilot1");
    await loadTableData("SubPilot1");
    await loadTableData("PilotList");

    console.log("‚úÖ Alle Daten geladen. Starte Berechnung...");
    starteBerechnung();
}

// Neue Berechnungsfunktion (statt setTimeout())
function starteBerechnung() {
    console.log("üöÄ Starte Berechnung...");




    const currentDate = new Date();
    
    // setTimeout(() => {

      

// const f√ºr auto-Email      
      const getLiLane1Pilot1 = document.getElementById("LiLane1Pilot1").innerText;
      const getLiLane2Pilot1 = document.getElementById("LiLane2Pilot1").innerText;
      const getLiLane3Pilot1 = document.getElementById("LiLane3Pilot1").innerText;
      const getLiLane4Pilot1 = document.getElementById("LiLane4Pilot1").innerText;
      const getLiLane5Pilot1 = document.getElementById("LiLane5Pilot1").innerText;
      const getLiLane6Pilot1 = document.getElementById("LiLane6Pilot1").innerText;
      const getLiLane7Pilot1 = document.getElementById("LiLane7Pilot1").innerText;
      const getLiLane8Pilot1 = document.getElementById("LiLane8Pilot1").innerText;
      const getLiLane9Pilot1 = document.getElementById("LiLane9Pilot1").innerText;
      const getLiLane10Pilot1 = document.getElementById("LiLane10Pilot1").innerText;
      const getLiLane11Pilot1 = document.getElementById("LiLane11Pilot1").innerText;
      const getLiLane12Pilot1 = document.getElementById("LiLane12Pilot1").innerText;
      const getLiLane13Pilot1 = document.getElementById("LiLane13Pilot1").innerText;
      const getLiLane14Pilot1 = document.getElementById("LiLane14Pilot1").innerText;
      const getLiLane15Pilot1 = document.getElementById("LiLane15Pilot1").innerText;


 // LiLane1 Pilot1 --------Anfang---------------------------------------------

      
      const NameTablePilot1 = document.getElementById("NamePilot1").innerText;
      const LicenseNameTablePilot1 = document.getElementById("LicenseNoPilot1").innerText;
      document.querySelector("#headPilot1").innerText = `${NameTablePilot1}  / License No.: ${LicenseNameTablePilot1}`;
      document.querySelector("#headSubPilot1").innerText = `${NameTablePilot1}  / License No.: ${LicenseNameTablePilot1}`;

      document.querySelector("#ListNamePilot1").innerText = `${NameTablePilot1}`;
      document.querySelector("#PageNamePilot1").innerText = `${NameTablePilot1}`;

console.log(NameTablePilot1);
console.log(getLiLane1Pilot1);


// Hol das Datum aus dem Input-Feld
let lastCheckLiLane1Pilot1 = document.getElementById("lastCheck_Pilot1_2_1").value;
let ValidityLiLane1Pilot1 = document.getElementById("validityLiLane1Pilot1").innerText;
let validityLiLane1Pilot1 = +ValidityLiLane1Pilot1;




console.log(lastCheckLiLane1Pilot1);
console.log(typeof lastCheckLiLane1Pilot1);



    // YYYY-MM-DD in Jahr, Monat, Tag aufteilen
    let parts = lastCheckLiLane1Pilot1.split("-");

    // Neues Date-Objekt mit (Jahr, Monat-1, Tag) erstellen
    let DateInputLiLane1Pilot1 = new Date(parts[0], parts[1] - 1, parts[2]);

    DateInputLiLane1Pilot1.setMonth(DateInputLiLane1Pilot1.getMonth() + validityLiLane1Pilot1);

    //let currentDate = new Date();

    // Verbleibende Tage ausrechnen
    const remainingTimeLiLane1Pilot1 = DateInputLiLane1Pilot1 - currentDate;
    const remainingDaysLiLane1Pilot1 = Math.floor(remainingTimeLiLane1Pilot1 / (1000 * 60 * 60 * 24)) + 1;
    console.log(remainingDaysLiLane1Pilot1);
    console.log(typeof remainingDaysLiLane1Pilot1);
    document.getElementById("remDaysLiLane1Pilot1").innerText = remainingDaysLiLane1Pilot1;


    // DD-MM-YYYY aus Date-Objekt erstellen (damit keine Zeitzonenprobleme auftreten)
    let day = DateInputLiLane1Pilot1.getDate().toString().padStart(2, "0");
    let month = (DateInputLiLane1Pilot1.getMonth() + 1).toString().padStart(2, "0"); // Monate in JS starten bei 0
    let year = DateInputLiLane1Pilot1.getFullYear();

    let formattedDate = `${day}-${month}-${year}`;

    console.log("Eingegebenes Datum (DD-MM-YYYY):", formattedDate);

    // In die zweite Zelle schreiben
    document.getElementById("newExpiryDateLiLane1Pilot1").innerText = formattedDate;



                    if (remainingDaysLiLane1Pilot1 <= 30 && !document.getElementById("emailSent30LiLane1Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane1Pilot1} license`;
                      const body = `Your ${getLiLane1Pilot1} is going to expire. 30 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent30LiLane1Pilot1").checked = true;
                    } else if (remainingDaysLiLane1Pilot1 <= 60 && !document.getElementById("emailSent60LiLane1Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane1Pilot1} license`;
                      const body = `Your ${getLiLane1Pilot1} is going to expire. 60 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent60LiLane1Pilot1").checked = true;
                    } else if (remainingDaysLiLane1Pilot1 <= 90 && !document.getElementById("emailSent90LiLane1Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane1Pilot1} license`;
                      const body = `Your ${getLiLane1Pilot1} is going to expire. 90 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent90LiLane1Pilot1").checked = true;
                    }

// LiLane1 Pilot1 --------Ende---------------------------------------------



// MUSS NACHHER ANS ENDE
// Wenn remDays < 90 dann die Zelle gelb f√§rben
document.querySelectorAll(".remDays").forEach(zelle => {
      let zahl = parseInt(zelle.innerText, 10);

      if (zahl <= 0) {
        zelle.style.backgroundColor = "red";
        zelle.style.color = "white";
      } else if (zahl <= 90) {
        zelle.style.backgroundColor = "yellow";
      }
    });







// LiLane 2 Pilot1 --------Anfang---------------------------------------------

                    let ValidityStringLiLane2Pilot1 = document.getElementById("validityLiLane2Pilot1").innerText;
                    let validityLiLane2Pilot1 = +ValidityStringLiLane2Pilot1;

                    function addMonthsToDateLiLane2Pilot1(date, months) {
                        let newDateLiLane2Pilot1 = new Date(document.getElementById("lastCheckLiLane2Pilot1").innerText);
                        newDateLiLane2Pilot1.setMonth(newDateLiLane2Pilot1.getMonth() + months);
                        return newDateLiLane2Pilot1;
                    }

                    let LastCheckLiLane2Pilot1 = new Date(document.getElementById("lastCheckLiLane2Pilot1").innerText);

                    let NewExpiryDateLiLane2Pilot1 = addMonthsToDateLiLane2Pilot1(LastCheckLiLane2Pilot1, validityLiLane2Pilot1);
                    document.getElementById("newExpiryDateLiLane2Pilot1").innerText = NewExpiryDateLiLane2Pilot1.toLocaleDateString();
              
                    const remainingTimeLiLane2Pilot1 = NewExpiryDateLiLane2Pilot1 - currentDate;
                    const remainingDaysLiLane2Pilot1 = Math.floor(remainingTimeLiLane2Pilot1 / (1000 * 60 * 60 * 24));
                    document.getElementById("remDaysLiLane2Pilot1").innerText = remainingDaysLiLane2Pilot1;
                    if (remainingDaysLiLane2Pilot1 <= 30 && !document.getElementById("emailSent30LiLane2Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane2Pilot1} license`;
                      const body = `Your ${getLiLane2Pilot1} is going to expire. 30 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent30LiLane2Pilot1").checked = true;
                    } else if (remainingDaysLiLane2Pilot1 <= 60 && !document.getElementById("emailSent60LiLane2Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane2Pilot1} license`;
                      const body = `Your ${getLiLane2Pilot1} is going to expire. 60 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent60LiLane2Pilot1").checked = true;
                    } else if (remainingDaysLiLane2Pilot1 <= 90 && !document.getElementById("emailSent90LiLane2Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane2Pilot1} license`;
                      const body = `Your ${getLiLane2Pilot1} is going to expire. 90 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent90LiLane2Pilot1").checked = true;
                    }

// LiLane2 Pilot1 --------Ende---------------------------------------------


// LiLane3 Pilot1 --------Anfang---------------------------------------------

                    let ValidityStringLiLane3Pilot1 = document.getElementById("validityLiLane3Pilot1").innerText;
                    let validityLiLane3Pilot1 = +ValidityStringLiLane3Pilot1;

                    function addMonthsToDateLiLane3Pilot1(date, months) {
                        let newDateLiLane3Pilot1 = new Date(document.getElementById("lastCheckLiLane3Pilot1").innerText);
                        newDateLiLane3Pilot1.setMonth(newDateLiLane3Pilot1.getMonth() + months);
                        return newDateLiLane3Pilot1;
                    }

                    let LastCheckLiLane3Pilot1 = new Date(document.getElementById("lastCheckLiLane3Pilot1").innerText);
            
                    let NewExpiryDateLiLane3Pilot1 = addMonthsToDateLiLane3Pilot1(LastCheckLiLane3Pilot1, validityLiLane3Pilot1);
                    document.getElementById("newExpiryDateLiLane3Pilot1").innerText = NewExpiryDateLiLane3Pilot1.toLocaleDateString();
           
                    const remainingTimeLiLane3Pilot1 = NewExpiryDateLiLane3Pilot1 - currentDate;
                    const remainingDaysLiLane3Pilot1 = Math.floor(remainingTimeLiLane3Pilot1 / (1000 * 60 * 60 * 24));
                    document.getElementById("remDaysLiLane3Pilot1").innerText = remainingDaysLiLane3Pilot1;
                    if (remainingDaysLiLane3Pilot1 <= 30 && !document.getElementById("emailSent30LiLane3Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane3Pilot1} license`;
                      const body = `Your ${getLiLane3Pilot1} is going to expire. 30 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent30LiLane3Pilot1").checked = true;
                    } else if (remainingDaysLiLane3Pilot1 <= 60 && !document.getElementById("emailSent60LiLane3Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane3Pilot1} license`;
                      const body = `Your ${getLiLane3Pilot1} is going to expire. 60 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent60LiLane3Pilot1").checked = true;
                    } else if (remainingDaysLiLane3Pilot1 <= 90 && !document.getElementById("emailSent90LiLane3Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane3Pilot1} license`;
                      const body = `Your ${getLiLane3Pilot1} is going to expire. 90 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent90LiLane3Pilot1").checked = true;
                    }

// LiLane3 Pilot1 --------Ende---------------------------------------------   


// LiLane4 Pilot1 --------Anfang---------------------------------------------

                    let ValidityStringLiLane4Pilot1 = document.getElementById("validityLiLane4Pilot1").innerText;
                    let validityLiLane4Pilot1 = +ValidityStringLiLane4Pilot1;

                    function addMonthsToDateLiLane4Pilot1(date, months) {
                        let newDateLiLane4Pilot1 = new Date(document.getElementById("lastCheckLiLane4Pilot1").innerText);
                        newDateLiLane4Pilot1.setMonth(newDateLiLane4Pilot1.getMonth() + months);
                        return newDateLiLane4Pilot1;
                    }

                    let LastCheckLiLane4Pilot1 = new Date(document.getElementById("lastCheckLiLane4Pilot1").innerText);
            
                    let NewExpiryDateLiLane4Pilot1 = addMonthsToDateLiLane4Pilot1(LastCheckLiLane4Pilot1, validityLiLane4Pilot1);
                    document.getElementById("newExpiryDateLiLane4Pilot1").innerText = NewExpiryDateLiLane4Pilot1.toLocaleDateString();
           
                    const remainingTimeLiLane4Pilot1 = NewExpiryDateLiLane4Pilot1 - currentDate;
                    const remainingDaysLiLane4Pilot1 = Math.floor(remainingTimeLiLane4Pilot1 / (1000 * 60 * 60 * 24));
                    document.getElementById("remDaysLiLane4Pilot1").innerText = remainingDaysLiLane4Pilot1;
                    if (remainingDaysLiLane4Pilot1 <= 30 && !document.getElementById("emailSent30LiLane4Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane4Pilot1} license`;
                      const body = `Your ${getLiLane4Pilot1} is going to expire. 30 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent30LiLane4Pilot1").checked = true;
                    } else if (remainingDaysLiLane4Pilot1 <= 60 && !document.getElementById("emailSent60LiLane4Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane4Pilot1} license`;
                      const body = `Your ${getLiLane4Pilot1} is going to expire. 60 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent60LiLane4Pilot1").checked = true;
                    } else if (remainingDaysLiLane4Pilot1 <= 90 && !document.getElementById("emailSent90LiLane4Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane4Pilot1} license`;
                      const body = `Your ${getLiLane4Pilot1} is going to expire. 90 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent90LiLane4Pilot1").checked = true;
                    }

// S&P Pilot1 --------Ende---------------------------------------------


// LiLane5 Pilot1 --------Anfang---------------------------------------------

                    let ValidityStringLiLane5Pilot1 = document.getElementById("validityLiLane5Pilot1").innerText;
                    let validityLiLane5Pilot1 = +ValidityStringLiLane5Pilot1;

                    function addMonthsToDateLiLane5Pilot1(date, months) {
                        let newDateLiLane5Pilot1 = new Date(document.getElementById("lastCheckLiLane5Pilot1").innerText);
                        newDateLiLane5Pilot1.setMonth(newDateLiLane5Pilot1.getMonth() + months);
                        return newDateLiLane5Pilot1;
                    }

                    let LastCheckLiLane5Pilot1 = new Date(document.getElementById("lastCheckLiLane5Pilot1").innerText);
            
                    let NewExpiryDateLiLane5Pilot1 = addMonthsToDateLiLane5Pilot1(LastCheckLiLane5Pilot1, validityLiLane5Pilot1);
                    document.getElementById("newExpiryDateLiLane5Pilot1").innerText = NewExpiryDateLiLane5Pilot1.toLocaleDateString();
           
                    const remainingTimeLiLane5Pilot1 = NewExpiryDateLiLane5Pilot1 - currentDate;
                    const remainingDaysLiLane5Pilot1 = Math.floor(remainingTimeLiLane5Pilot1 / (1000 * 60 * 60 * 24));
                    document.getElementById("remDaysLiLane5Pilot1").innerText = remainingDaysLiLane5Pilot1;
                    if (remainingDaysLiLane5Pilot1 <= 30 && !document.getElementById("emailSent30LiLane5Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane5Pilot1} license`;
                      const body = `Your ${getLiLane5Pilot1} is going to expire. 30 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent30LiLane5Pilot1").checked = true;
                    } else if (remainingDaysLiLane5Pilot1 <= 60 && !document.getElementById("emailSent60LiLane5Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane5Pilot1} license`;
                      const body = `Your ${getLiLane5Pilot1} is going to expire. 60 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent60LiLane5Pilot1").checked = true;
                    } else if (remainingDaysLiLane5Pilot1 <= 90 && !document.getElementById("emailSent90LiLane5Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane5Pilot1} license`;
                      const body = `Your ${getLiLane5Pilot1} is going to expire. 90 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent90LiLane5Pilot1").checked = true;
                    }

// LiLane5 Pilot1 --------Ende---------------------------------------------


// LiLane6 Pilot1 --------Anfang---------------------------------------------

                    let ValidityStringLiLane6Pilot1 = document.getElementById("validityLiLane6Pilot1").innerText;
                    let validityLiLane6Pilot1 = +ValidityStringLiLane6Pilot1;


                    function addMonthsToDateLiLane6Pilot1(date, months) {
                        let newDateLiLane6Pilot1 = new Date(document.getElementById("lastCheckLiLane6Pilot1").innerText);
                        newDateLiLane6Pilot1.setMonth(newDateLiLane6Pilot1.getMonth() + months);
                        return newDateLiLane6Pilot1;
                    }

                    let LastCheckLiLane6Pilot1 = new Date(document.getElementById("lastCheckLiLane6Pilot1").innerText);
            
                    let NewExpiryDateLiLane6Pilot1 = addMonthsToDateLiLane6Pilot1(LastCheckLiLane6Pilot1, validityLiLane6Pilot1);
                    document.getElementById("newExpiryDateLiLane6Pilot1").innerText = NewExpiryDateLiLane6Pilot1.toLocaleDateString();
           
                    const remainingTimeLiLane6Pilot1 = NewExpiryDateLiLane6Pilot1 - currentDate;
                    const remainingDaysLiLane6Pilot1 = Math.floor(remainingTimeLiLane6Pilot1 / (1000 * 60 * 60 * 24));
                    document.getElementById("remDaysLiLane6Pilot1").innerText = remainingDaysLiLane6Pilot1;
                    if (remainingDaysLiLane6Pilot1 <= 30 && !document.getElementById("emailSent30LiLane6Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane6Pilot1} license`;
                      const body = `Your ${getLiLane6Pilot1} is going to expire. 30 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent30LiLane6Pilot1").checked = true;
                    } else if (remainingDaysLiLane6Pilot1 <= 60 && !document.getElementById("emailSent60LiLane6Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane6Pilot1} license`;
                      const body = `Your ${getLiLane6Pilot1} is going to expire. 60 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent60LiLane6Pilot1").checked = true;
                    } else if (remainingDaysLiLane6Pilot1 <= 90 && !document.getElementById("emailSent90LiLane6Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane6Pilot1} license`;
                      const body = `Your ${getLiLane6Pilot1} is going to expire. 90 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent90LiLane6Pilot1").checked = true;
                    }

// LiLane6 Pilot1 --------Ende---------------------------------------------   


// LiLane7 Pilot1 --------Anfang---------------------------------------------

                    let ValidityStringLiLane7Pilot1 = document.getElementById("validityLiLane7Pilot1").innerText;
                    let validityLiLane7Pilot1 = +ValidityStringLiLane7Pilot1;

                    function addMonthsToDateLiLane7Pilot1(date, months) {
                        let newDateLiLane7Pilot1 = new Date(document.getElementById("lastCheckLiLane7Pilot1").innerText);
                        newDateLiLane7Pilot1.setMonth(newDateLiLane7Pilot1.getMonth() + months);
                        return newDateLiLane7Pilot1;
                    }

                    let LastCheckLiLane7Pilot1 = new Date(document.getElementById("lastCheckLiLane7Pilot1").innerText);
            
                    let NewExpiryDateLiLane7Pilot1 = addMonthsToDateLiLane7Pilot1(LastCheckLiLane7Pilot1, validityLiLane7Pilot1);
                    document.getElementById("newExpiryDateLiLane7Pilot1").innerText = NewExpiryDateLiLane7Pilot1.toLocaleDateString();
 
                    const remainingTimeLiLane7Pilot1 = NewExpiryDateLiLane7Pilot1 - currentDate;
                    const remainingDaysLiLane7Pilot1 = Math.floor(remainingTimeLiLane7Pilot1 / (1000 * 60 * 60 * 24));
                    document.getElementById("remDaysLiLane7Pilot1").innerText = remainingDaysLiLane7Pilot1;
                    if (remainingDaysLiLane7Pilot1 <= 30 && !document.getElementById("emailSent30LiLane7Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane7Pilot1} license`;
                      const body = `Your ${getLiLane7Pilot1} is going to expire. 30 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent30LiLane7Pilot1").checked = true;
                    } else if (remainingDaysLiLane7Pilot1 <= 60 && !document.getElementById("emailSent60LiLane7Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane7Pilot1} license`;
                      const body = `Your ${getLiLane7Pilot1} is going to expire. 60 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent60LiLane7Pilot1").checked = true;
                    } else if (remainingDaysLiLane7Pilot1 <= 90 && !document.getElementById("emailSent90LiLane7Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane7Pilot1} license`;
                      const body = `Your ${getLiLane7Pilot1} is going to expire. 90 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent90LiLane7Pilot1").checked = true;
                    }

// LiLane7 Pilot1 --------Ende---------------------------------------------


// LiLane8 Pilot1 --------Anfang---------------------------------------------

                    let ValidityStringLiLane8Pilot1 = document.getElementById("validityLiLane8Pilot1").innerText;
                    let validityLiLane8Pilot1 = +ValidityStringLiLane8Pilot1;

                    function addMonthsToDateLiLane8Pilot1(date, months) {
                        let newDateLiLane8Pilot1 = new Date(document.getElementById("lastCheckLiLane8Pilot1").innerText);
                        newDateLiLane8Pilot1.setMonth(newDateLiLane8Pilot1.getMonth() + months);
                        return newDateLiLane8Pilot1;
                    }

                    let LastCheckLiLane8Pilot1 = new Date(document.getElementById("lastCheckLiLane8Pilot1").innerText);
            
                    let NewExpiryDateLiLane8Pilot1 = addMonthsToDateLiLane8Pilot1(LastCheckLiLane8Pilot1, validityLiLane8Pilot1);
                    document.getElementById("newExpiryDateLiLane8Pilot1").innerText = NewExpiryDateLiLane8Pilot1.toLocaleDateString();
           
                    const remainingTimeLiLane8Pilot1 = NewExpiryDateLiLane8Pilot1 - currentDate;
                    const remainingDaysLiLane8Pilot1 = Math.floor(remainingTimeLiLane8Pilot1 / (1000 * 60 * 60 * 24));
                    document.getElementById("remDaysLiLane8Pilot1").innerText = remainingDaysLiLane8Pilot1;
                    if (remainingDaysLiLane8Pilot1 <= 30 && !document.getElementById("emailSent30LiLane8Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane8Pilot1} license`;
                      const body = `Your ${getLiLane8Pilot1} is going to expire. 30 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent30LiLane8Pilot1").checked = true;
                    } else if (remainingDaysLiLane8Pilot1 <= 60 && !document.getElementById("emailSent60LiLane8Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane8Pilot1} license`;
                      const body = `Your ${getLiLane8Pilot1} is going to expire. 60 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent60LiLane8Pilot1").checked = true;
                    } else if (remainingDaysLiLane8Pilot1 <= 90 && !document.getElementById("emailSent90LiLane8Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane8Pilot1} license`;
                      const body = `Your ${getLiLane8Pilot1} is going to expire. 90 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent90LiLane8Pilot1").checked = true;
                    }

// LiLane8 Pilot1 --------Ende---------------------------------------------

// LiLane9 Pilot1 --------Anfang---------------------------------------------

let ValidityStringLiLane9Pilot1 = document.getElementById("validityLiLane9Pilot1").innerText;
                    let validityLiLane9Pilot1 = +ValidityStringLiLane9Pilot1;

                    function addMonthsToDateLiLane9Pilot1(date, months) {
                        let newDateLiLane9Pilot1 = new Date(document.getElementById("lastCheckLiLane9Pilot1").innerText);
                        newDateLiLane9Pilot1.setMonth(newDateLiLane9Pilot1.getMonth() + months);
                        return newDateLiLane9Pilot1;
                    }

                    let LastCheckLiLane9Pilot1 = new Date(document.getElementById("lastCheckLiLane9Pilot1").innerText);
                    let NewExpiryDateLiLane9Pilot1 = addMonthsToDateLiLane9Pilot1(LastCheckLiLane9Pilot1, validityLiLane9Pilot1);
                    document.getElementById("newExpiryDateLiLane9Pilot1").innerText = NewExpiryDateLiLane9Pilot1.toLocaleDateString();
           
                    const remainingTimeLiLane9Pilot1 = NewExpiryDateLiLane9Pilot1 - currentDate;
                    const remainingDaysLiLane9Pilot1 = Math.floor(remainingTimeLiLane9Pilot1 / (1000 * 60 * 60 * 24));
                    document.getElementById("remDaysLiLane9Pilot1").innerText = remainingDaysLiLane9Pilot1;
                    if (remainingDaysLiLane9Pilot1 <= 30 && !document.getElementById("emailSent30LiLane9Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane9Pilot1} license`;
                      const body = `Your ${getLiLane9Pilot1} is going to expire. 30 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent30LiLane9Pilot1").checked = true;
                    } else if (remainingDaysLiLane9Pilot1 <= 60 && !document.getElementById("emailSent60LiLane9Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane9Pilot1} license`;
                      const body = `Your ${getLiLane9Pilot1} is going to expire. 60 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent60LiLane9Pilot1").checked = true;
                    } else if (remainingDaysLiLane9Pilot1 <= 90 && !document.getElementById("emailSent90LiLane9Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane9Pilot1} license`;
                      const body = `Your ${getLiLane9Pilot1} is going to expire. 90 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent90LiLane9Pilot1").checked = true;
                    }

// LiLane9 Pilot1 --------Ende---------------------------------------------

// LiLane10 Pilot1 --------Anfang---------------------------------------------

let ValidityStringLiLane10Pilot1 = document.getElementById("validityLiLane10Pilot1").innerText;
                    let validityLiLane10Pilot1 = +ValidityStringLiLane10Pilot1;

                    function addMonthsToDateLiLane10Pilot1(date, months) {
                        let newDateLiLane10Pilot1 = new Date(document.getElementById("lastCheckLiLane10Pilot1").innerText);
                        newDateLiLane10Pilot1.setMonth(newDateLiLane10Pilot1.getMonth() + months);
                        return newDateLiLane10Pilot1;
                    }

                    let LastCheckLiLane10Pilot1 = new Date(document.getElementById("lastCheckLiLane10Pilot1").innerText);
                    let NewExpiryDateLiLane10Pilot1 = addMonthsToDateLiLane10Pilot1(LastCheckLiLane10Pilot1, validityLiLane10Pilot1);
                    document.getElementById("newExpiryDateLiLane10Pilot1").innerText = NewExpiryDateLiLane10Pilot1.toLocaleDateString();
           
                    const remainingTimeLiLane10Pilot1 = NewExpiryDateLiLane10Pilot1 - currentDate;
                    const remainingDaysLiLane10Pilot1 = Math.floor(remainingTimeLiLane10Pilot1 / (1000 * 60 * 60 * 24));
                    document.getElementById("remDaysLiLane10Pilot1").innerText = remainingDaysLiLane10Pilot1;
                    if (remainingDaysLiLane10Pilot1 <= 30 && !document.getElementById("emailSent30LiLane10Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane10Pilot1} license`;
                      const body = `Your ${getLiLane10Pilot1} is going to expire. 30 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent30LiLane10Pilot1").checked = true;
                    } else if (remainingDaysLiLane10Pilot1 <= 60 && !document.getElementById("emailSent60LiLane10Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane10Pilot1} license`;
                      const body = `Your ${getLiLane10Pilot1} is going to expire. 60 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent60LiLane10Pilot1").checked = true;
                    } else if (remainingDaysLiLane10Pilot1 <= 90 && !document.getElementById("emailSent90LiLane10Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane10Pilot1} license`;
                      const body = `Your ${getLiLane10Pilot1} is going to expire. 90 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent90LiLane10Pilot1").checked = true;
                    }

// LiLane10 Pilot1 --------Ende---------------------------------------------

// LiLane11 Pilot1 --------Anfang---------------------------------------------

let ValidityStringLiLane11Pilot1 = document.getElementById("validityLiLane11Pilot1").innerText;
                    let validityLiLane11Pilot1 = +ValidityStringLiLane11Pilot1;

                    function addMonthsToDateLiLane11Pilot1(date, months) {
                        let newDateLiLane11Pilot1 = new Date(document.getElementById("lastCheckLiLane11Pilot1").innerText);
                        newDateLiLane11Pilot1.setMonth(newDateLiLane11Pilot1.getMonth() + months);
                        return newDateLiLane11Pilot1;
                    }

                    let LastCheckLiLane11Pilot1 = new Date(document.getElementById("lastCheckLiLane11Pilot1").innerText);
                    let NewExpiryDateLiLane11Pilot1 = addMonthsToDateLiLane11Pilot1(LastCheckLiLane11Pilot1, validityLiLane11Pilot1);
                    document.getElementById("newExpiryDateLiLane11Pilot1").innerText = NewExpiryDateLiLane11Pilot1.toLocaleDateString();
           
                    const remainingTimeLiLane11Pilot1 = NewExpiryDateLiLane11Pilot1 - currentDate;
                    const remainingDaysLiLane11Pilot1 = Math.floor(remainingTimeLiLane11Pilot1 / (1000 * 60 * 60 * 24));
                    document.getElementById("remDaysLiLane11Pilot1").innerText = remainingDaysLiLane11Pilot1;
                    if (remainingDaysLiLane11Pilot1 <= 30 && !document.getElementById("emailSent30LiLane11Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane11Pilot1} license`;
                      const body = `Your ${getLiLane11Pilot1} is going to expire. 30 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent30LiLane11Pilot1").checked = true;
                    } else if (remainingDaysLiLane11Pilot1 <= 60 && !document.getElementById("emailSent60LiLane11Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane11Pilot1} license`;
                      const body = `Your ${getLiLane11Pilot1} is going to expire. 60 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent60LiLane11Pilot1").checked = true;
                    } else if (remainingDaysLiLane11Pilot1 <= 90 && !document.getElementById("emailSent90LiLane11Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane11Pilot1} license`;
                      const body = `Your ${getLiLane11Pilot1} is going to expire. 90 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent90LiLane11Pilot1").checked = true;
                    }

// LiLane11 Pilot1 --------Ende---------------------------------------------

// LiLane12 Pilot1 --------Anfang---------------------------------------------

let ValidityStringLiLane12Pilot1 = document.getElementById("validityLiLane12Pilot1").innerText;
                    let validityLiLane12Pilot1 = +ValidityStringLiLane12Pilot1;

                    function addMonthsToDateLiLane12Pilot1(date, months) {
                        let newDateLiLane12Pilot1 = new Date(document.getElementById("lastCheckLiLane12Pilot1").innerText);
                        newDateLiLane12Pilot1.setMonth(newDateLiLane12Pilot1.getMonth() + months);
                        return newDateLiLane12Pilot1;
                    }

                    let LastCheckLiLane12Pilot1 = new Date(document.getElementById("lastCheckLiLane12Pilot1").innerText);
                    let NewExpiryDateLiLane12Pilot1 = addMonthsToDateLiLane12Pilot1(LastCheckLiLane12Pilot1, validityLiLane12Pilot1);
                    document.getElementById("newExpiryDateLiLane12Pilot1").innerText = NewExpiryDateLiLane12Pilot1.toLocaleDateString();
           
                    const remainingTimeLiLane12Pilot1 = NewExpiryDateLiLane12Pilot1 - currentDate;
                    const remainingDaysLiLane12Pilot1 = Math.floor(remainingTimeLiLane12Pilot1 / (1000 * 60 * 60 * 24));
                    document.getElementById("remDaysLiLane12Pilot1").innerText = remainingDaysLiLane12Pilot1;
                    if (remainingDaysLiLane12Pilot1 <= 30 && !document.getElementById("emailSent30LiLane12Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane12Pilot1} license`;
                      const body = `Your ${getLiLane12Pilot1} is going to expire. 30 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent30LiLane12Pilot1").checked = true;
                    } else if (remainingDaysLiLane12Pilot1 <= 60 && !document.getElementById("emailSent60LiLane12Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane12Pilot1} license`;
                      const body = `Your ${getLiLane12Pilot1} is going to expire. 60 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent60LiLane12Pilot1").checked = true;
                    } else if (remainingDaysLiLane12Pilot1 <= 90 && !document.getElementById("emailSent90LiLane12Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane12Pilot1} license`;
                      const body = `Your ${getLiLane12Pilot1} is going to expire. 90 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent90LiLane12Pilot1").checked = true;
                    }

// LiLane12 Pilot1 --------Ende---------------------------------------------

// LiLane13 Pilot1 --------Anfang---------------------------------------------

let ValidityStringLiLane13Pilot1 = document.getElementById("validityLiLane13Pilot1").innerText;
                    let validityLiLane13Pilot1 = +ValidityStringLiLane13Pilot1;

                    function addMonthsToDateLiLane13Pilot1(date, months) {
                        let newDateLiLane13Pilot1 = new Date(document.getElementById("lastCheckLiLane13Pilot1").innerText);
                        newDateLiLane13Pilot1.setMonth(newDateLiLane13Pilot1.getMonth() + months);
                        return newDateLiLane13Pilot1;
                    }

                    let LastCheckLiLane13Pilot1 = new Date(document.getElementById("lastCheckLiLane13Pilot1").innerText);
                    let NewExpiryDateLiLane13Pilot1 = addMonthsToDateLiLane13Pilot1(LastCheckLiLane13Pilot1, validityLiLane13Pilot1);
                    document.getElementById("newExpiryDateLiLane13Pilot1").innerText = NewExpiryDateLiLane13Pilot1.toLocaleDateString();
           
                    const remainingTimeLiLane13Pilot1 = NewExpiryDateLiLane13Pilot1 - currentDate;
                    const remainingDaysLiLane13Pilot1 = Math.floor(remainingTimeLiLane13Pilot1 / (1000 * 60 * 60 * 24));
                    document.getElementById("remDaysLiLane13Pilot1").innerText = remainingDaysLiLane13Pilot1;
                    if (remainingDaysLiLane13Pilot1 <= 30 && !document.getElementById("emailSent30LiLane13Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane13Pilot1} license`;
                      const body = `Your ${getLiLane13Pilot1} is going to expire. 30 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent30LiLane13Pilot1").checked = true;
                    } else if (remainingDaysLiLane13Pilot1 <= 60 && !document.getElementById("emailSent60LiLane13Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane13Pilot1} license`;
                      const body = `Your ${getLiLane13Pilot1} is going to expire. 60 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent60LiLane13Pilot1").checked = true;
                    } else if (remainingDaysLiLane13Pilot1 <= 90 && !document.getElementById("emailSent90LiLane13Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane13Pilot1} license`;
                      const body = `Your ${getLiLane13Pilot1} is going to expire. 90 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent90LiLane13Pilot1").checked = true;
                    }

// LiLane13 Pilot1 --------Ende---------------------------------------------

// LiLane14 Pilot1 --------Anfang---------------------------------------------

let ValidityStringLiLane14Pilot1 = document.getElementById("validityLiLane14Pilot1").innerText;
                    let validityLiLane14Pilot1 = +ValidityStringLiLane14Pilot1;

                    function addMonthsToDateLiLane14Pilot1(date, months) {
                        let newDateLiLane14Pilot1 = new Date(document.getElementById("lastCheckLiLane14Pilot1").innerText);
                        newDateLiLane14Pilot1.setMonth(newDateLiLane14Pilot1.getMonth() + months);
                        return newDateLiLane14Pilot1;
                    }

                    let LastCheckLiLane14Pilot1 = new Date(document.getElementById("lastCheckLiLane14Pilot1").innerText);
                    let NewExpiryDateLiLane14Pilot1 = addMonthsToDateLiLane14Pilot1(LastCheckLiLane14Pilot1, validityLiLane14Pilot1);
                    document.getElementById("newExpiryDateLiLane14Pilot1").innerText = NewExpiryDateLiLane14Pilot1.toLocaleDateString();
           
                    const remainingTimeLiLane14Pilot1 = NewExpiryDateLiLane14Pilot1 - currentDate;
                    const remainingDaysLiLane14Pilot1 = Math.floor(remainingTimeLiLane14Pilot1 / (1000 * 60 * 60 * 24));
                    document.getElementById("remDaysLiLane14Pilot1").innerText = remainingDaysLiLane14Pilot1;
                    if (remainingDaysLiLane14Pilot1 <= 30 && !document.getElementById("emailSent30LiLane14Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane14Pilot1} license`;
                      const body = `Your ${getLiLane14Pilot1} is going to expire. 30 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent30LiLane14Pilot1").checked = true;
                    } else if (remainingDaysLiLane14Pilot1 <= 60 && !document.getElementById("emailSent60LiLane14Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane14Pilot1} license`;
                      const body = `Your ${getLiLane14Pilot1} is going to expire. 60 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent60LiLane14Pilot1").checked = true;
                    } else if (remainingDaysLiLane14Pilot1 <= 90 && !document.getElementById("emailSent90LiLane14Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane14Pilot1} license`;
                      const body = `Your ${getLiLane14Pilot1} is going to expire. 90 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent90LiLane14Pilot1").checked = true;
                    }

// LiLane14 Pilot1 --------Ende---------------------------------------------

// LiLane15 Pilot1 --------Anfang---------------------------------------------

let ValidityStringLiLane15Pilot1 = document.getElementById("validityLiLane15Pilot1").innerText;
                    let validityLiLane15Pilot1 = +ValidityStringLiLane15Pilot1;

                    function addMonthsToDateLiLane15Pilot1(date, months) {
                        let newDateLiLane15Pilot1 = new Date(document.getElementById("lastCheckLiLane15Pilot1").innerText);
                        newDateLiLane15Pilot1.setMonth(newDateLiLane15Pilot1.getMonth() + months);
                        return newDateLiLane15Pilot1;
                    }

                    let LastCheckLiLane15Pilot1 = new Date(document.getElementById("lastCheckLiLane15Pilot1").innerText);
                    let NewExpiryDateLiLane15Pilot1 = addMonthsToDateLiLane15Pilot1(LastCheckLiLane15Pilot1, validityLiLane15Pilot1);
                    document.getElementById("newExpiryDateLiLane15Pilot1").innerText = NewExpiryDateLiLane15Pilot1.toLocaleDateString();
           
                    const remainingTimeLiLane15Pilot1 = NewExpiryDateLiLane15Pilot1 - currentDate;
                    const remainingDaysLiLane15Pilot1 = Math.floor(remainingTimeLiLane15Pilot1 / (1000 * 60 * 60 * 24));
                    document.getElementById("remDaysLiLane15Pilot1").innerText = remainingDaysLiLane15Pilot1;
                    if (remainingDaysLiLane15Pilot1 <= 30 && !document.getElementById("emailSent30LiLane15Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane15Pilot1} license`;
                      const body = `Your ${getLiLane15Pilot1} is going to expire. 30 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent30LiLane15Pilot1").checked = true;
                    } else if (remainingDaysLiLane15Pilot1 <= 60 && !document.getElementById("emailSent60LiLane15Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane15Pilot1} license`;
                      const body = `Your ${getLiLane15Pilot1} is going to expire. 60 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent60LiLane15Pilot1").checked = true;
                    } else if (remainingDaysLiLane15Pilot1 <= 90 && !document.getElementById("emailSent90LiLane15Pilot1").checked) {
                      const recipient = 'Pilot1@abc.com';
                      const ccRecipient = 'xxx@abc.com, xyz@abc.com';  // Hier die CC-E-Mail-Adresse einf√ºgen, weitere emails durch Komma getrennt
                      const subject = `Automated Email - ${getLiLane15Pilot1} license`;
                      const body = `Your ${getLiLane15Pilot1} is going to expire. 90 Days left. Please contact xxx.`;

                      // Korrekte Mailto-URL mit CC
                      const mailtoLink = `mailto:${recipient}?cc=${encodeURIComponent(ccRecipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

                      // E-Mail-Link √∂ffnen (E-Mail-Client wird ge√∂ffnet)
                      window.location.href = mailtoLink;

                      // Optional: Checkbox nach dem Senden der E-Mail aktualisieren
                      document.getElementById("emailSent90LiLane15Pilot1").checked = true;
                    }

// LiLane15 Pilot1 --------Ende---------------------------------------------








// =======================================================================




// PILOT 2
     

            
          };
        
  
         


</script>

</body>
</html>



